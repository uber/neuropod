load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")
load("//bazel:python.bzl", "python_repository")
load("//bazel:tensorflow.bzl", "tensorflow_repository")
load("//bazel:libtorch.bzl", "libtorch_repository")

# Use an internal LLVM toolchain instead of the system one
http_archive(
    name = "com_grail_bazel_toolchain",
    strip_prefix = "bazel-toolchain-64bb7aa409c384fb9a35f331adb31658f08eb8bb",
    sha256 = "939b5b58b56946fe38deab6e9f65817a557a5d7a93d2b933b4716ff2cf1e0527",
    url = "https://github.com/grailbio/bazel-toolchain/archive/64bb7aa409c384fb9a35f331adb31658f08eb8bb.tar.gz",
    patches = ["@//bazel:toolchain.patch"],
)

load("@com_grail_bazel_toolchain//toolchain:rules.bzl", "llvm_toolchain")

llvm_toolchain(
    name = "llvm_toolchain",
    llvm_version = "8.0.0",
)

libtorch_repository(
    name = "libtorch_repo",
    build_file_template = "@//deps:BUILD.libtorch",
)

tensorflow_repository(
    name = "tensorflow_repo",
    build_file = "@//deps:BUILD.tensorflow",
)

http_archive(
    name = "libjsoncpp_repo",
    build_file = "@//deps:BUILD.libjsoncpp",
    sha256 = "c49deac9e0933bcb7044f08516861a2d560988540b23de2ac1ad443b219afdb6",
    strip_prefix = "jsoncpp-1.8.4",
    url = "https://github.com/open-source-parsers/jsoncpp/archive/1.8.4.tar.gz",
)

http_archive(
    name = "boost_repo",
    build_file = "@//deps:BUILD.boost",
    sha256 = "3b1db0b67079266c40b98329d85916e910bbadfc3db3e860c049056788d4d5cd",
    type = "zip",
    url = "https://downloads.sourceforge.net/project/boost/boost/1.68.0/boost_1_68_0.zip",
    strip_prefix = "boost_1_68_0",
)

http_archive(
    name = "pybind11_repo",
    build_file = "@//deps:BUILD.pybind11",
    sha256 = "c62073cd8d4f9209ad64092279e757f5fd83327a5b17a72c04fd0fea27d0d593",
    type = "zip",
    url = "https://github.com/pybind/pybind11/archive/v2.2.4.zip",
    strip_prefix = "pybind11-2.2.4",
)

python_repository(
    name = "python_repo",
    build_file_template = "@//deps:BUILD.python",
)

http_archive(
    name = "gtest",
    url = "https://github.com/google/googletest/archive/release-1.8.0.zip",
    sha256 = "f3ed3b58511efd272eb074a3a6d6fb79d7c2e6a0e374323d1e6bcbcc1ef141bf",
    build_file = "@//deps:BUILD.gtest",
    strip_prefix = "googletest-release-1.8.0",
)

http_archive(
    name = "benchmark",
    url = "https://github.com/google/benchmark/archive/v1.5.0.zip",
    sha256 = "2d22dd3758afee43842bb504af1a8385cccb3ee1f164824e4837c1c1b04d92a0",
    build_file = "@//deps:BUILD.benchmark",
    strip_prefix = "benchmark-1.5.0",
)


http_archive(
    name = "eigen3_repo",
    build_file = "@//deps:BUILD.eigen3",
    sha256 = "3b025b3f82f2b95eb66fced90521b798c169b00fb755ee7f48194cf2d6be2faf",
    url = "https://github.com/eigenteam/eigen-git-mirror/archive/3.2.10.zip",
    strip_prefix = "eigen-git-mirror-3.2.10",
)

http_archive(
    name = "mklml_repo_darwin",
    build_file = "@//deps:BUILD.mklml",
    sha256 = "2fbb71a0365d42a39ea7906568d69b1db3bfc9914fee75eedb06c5f32bf5fa68",
    url = "https://github.com/intel/mkl-dnn/releases/download/v0.19/mklml_mac_2019.0.5.20190502.tgz",
    strip_prefix = "mklml_mac_2019.0.5.20190502",
)
