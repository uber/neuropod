
#
# DO NOT MANUALLY EDIT THIS FILE
# AUTOGENERATED BY build/ci_matrix.py
#

steps:
  - label: ":docker: CPU Tests (test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9)"
    timeout_in_minutes: 60
    agents:
      queue: public-gpu
    env:
      NEUROPOD_TEST_FRAMEWORKS: tensorflow
    command: build/ci/buildkite_build.sh
    plugins:
      - docker-compose#v3.7.0:
          build: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          image-repository: 027047743804.dkr.ecr.us-east-2.amazonaws.com/uber
          cache-from: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          push-retries: 5
      - docker-compose#v3.7.0:
          push: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
      - docker-compose#v3.7.0:
          run: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          env:
            - NEUROPOD_CACHE_ACCESS_KEY
            - NEUROPOD_CACHE_ACCESS_SECRET
            - BUILDKITE
            - BUILDKITE_BRANCH
            - BUILDKITE_BUILD_NUMBER
            - BUILDKITE_BUILD_URL
            - BUILDKITE_COMMIT
            - BUILDKITE_JOB_ID
            - BUILDKITE_PROJECT_SLUG
            - BUILDKITE_PULL_REQUEST
            - BUILDKITE_TAG
            - CI
            - CODECOV_TOKEN
            - GH_STATUS_TOKEN
            - GH_UPLOAD_TOKEN
            - NEUROPOD_TEST_FRAMEWORKS
            - WEB_DEPLOY_KEY
    retry:
      automatic: true

  - label: ":docker: Lint + Docs"
    timeout_in_minutes: 60
    agents:
      queue: public-gpu
    command: build/ci/buildkite_lint.sh
    plugins:
      - docker-compose#v3.7.0:
          build: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          image-repository: 027047743804.dkr.ecr.us-east-2.amazonaws.com/uber
          cache-from: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          push-retries: 5
      - docker-compose#v3.7.0:
          push: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
      - docker-compose#v3.7.0:
          run: test-cpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          env:
            - NEUROPOD_CACHE_ACCESS_KEY
            - NEUROPOD_CACHE_ACCESS_SECRET
            - BUILDKITE
            - BUILDKITE_BRANCH
            - BUILDKITE_BUILD_NUMBER
            - BUILDKITE_BUILD_URL
            - BUILDKITE_COMMIT
            - BUILDKITE_JOB_ID
            - BUILDKITE_PROJECT_SLUG
            - BUILDKITE_PULL_REQUEST
            - BUILDKITE_TAG
            - CI
            - CODECOV_TOKEN
            - GH_STATUS_TOKEN
            - GH_UPLOAD_TOKEN
            - NEUROPOD_TEST_FRAMEWORKS
            - WEB_DEPLOY_KEY
    retry:
      automatic: true

  - label: ":docker: CPU Tests (test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9)"
    timeout_in_minutes: 60
    agents:
      queue: public-gpu
    env:
      NEUROPOD_TEST_FRAMEWORKS: tensorflow
    command: build/ci/buildkite_build.sh
    plugins:
      - docker-compose#v3.7.0:
          build: test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          image-repository: 027047743804.dkr.ecr.us-east-2.amazonaws.com/uber
          cache-from: test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          push-retries: 5
      - docker-compose#v3.7.0:
          push: test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
      - docker-compose#v3.7.0:
          run: test-cpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          env:
            - NEUROPOD_CACHE_ACCESS_KEY
            - NEUROPOD_CACHE_ACCESS_SECRET
            - BUILDKITE
            - BUILDKITE_BRANCH
            - BUILDKITE_BUILD_NUMBER
            - BUILDKITE_BUILD_URL
            - BUILDKITE_COMMIT
            - BUILDKITE_JOB_ID
            - BUILDKITE_PROJECT_SLUG
            - BUILDKITE_PULL_REQUEST
            - BUILDKITE_TAG
            - CI
            - CODECOV_TOKEN
            - GH_STATUS_TOKEN
            - GH_UPLOAD_TOKEN
            - NEUROPOD_TEST_FRAMEWORKS
            - WEB_DEPLOY_KEY
    retry:
      automatic: true

  - label: ":docker: GPU Tests (test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9)"
    timeout_in_minutes: 60
    agents:
      queue: public-gpu
    env:
      NEUROPOD_TEST_FRAMEWORKS: tensorflow
    command: build/ci/buildkite_build_gpu.sh
    plugins:
      - docker-compose#v3.7.0:
          build: test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          image-repository: 027047743804.dkr.ecr.us-east-2.amazonaws.com/uber
          cache-from: test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          push-retries: 5
      - docker-compose#v3.7.0:
          push: test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
      - docker-compose#v3.7.0:
          run: test-gpu-variant-tf-2_5_0-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          env:
            - NEUROPOD_CACHE_ACCESS_KEY
            - NEUROPOD_CACHE_ACCESS_SECRET
            - BUILDKITE
            - BUILDKITE_BRANCH
            - BUILDKITE_BUILD_NUMBER
            - BUILDKITE_BUILD_URL
            - BUILDKITE_COMMIT
            - BUILDKITE_JOB_ID
            - BUILDKITE_PROJECT_SLUG
            - BUILDKITE_PULL_REQUEST
            - BUILDKITE_TAG
            - CI
            - CODECOV_TOKEN
            - GH_STATUS_TOKEN
            - GH_UPLOAD_TOKEN
            - NEUROPOD_TEST_FRAMEWORKS
            - WEB_DEPLOY_KEY
    retry:
      automatic: true

  - label: ":docker: GPU Tests (test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9)"
    timeout_in_minutes: 60
    agents:
      queue: public-gpu
    env:
      NEUROPOD_TEST_FRAMEWORKS: tensorflow
    command: build/ci/buildkite_build_gpu.sh
    plugins:
      - docker-compose#v3.7.0:
          build: test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          image-repository: 027047743804.dkr.ecr.us-east-2.amazonaws.com/uber
          cache-from: test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          push-retries: 5
      - docker-compose#v3.7.0:
          push: test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9:027047743804.dkr.ecr.us-east-2.amazonaws.com/uber:test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
      - docker-compose#v3.7.0:
          run: test-gpu-variant-tf-2_6_2-torch-1_7_1-py3_9
          config: docker-compose.test.yml
          env:
            - NEUROPOD_CACHE_ACCESS_KEY
            - NEUROPOD_CACHE_ACCESS_SECRET
            - BUILDKITE
            - BUILDKITE_BRANCH
            - BUILDKITE_BUILD_NUMBER
            - BUILDKITE_BUILD_URL
            - BUILDKITE_COMMIT
            - BUILDKITE_JOB_ID
            - BUILDKITE_PROJECT_SLUG
            - BUILDKITE_PULL_REQUEST
            - BUILDKITE_TAG
            - CI
            - CODECOV_TOKEN
            - GH_STATUS_TOKEN
            - GH_UPLOAD_TOKEN
            - NEUROPOD_TEST_FRAMEWORKS
            - WEB_DEPLOY_KEY
    retry:
      automatic: true


